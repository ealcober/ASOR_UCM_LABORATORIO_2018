
Ejercicio 1. El archivo de configuración del cliente DNS es ​ /etc/resolv.conf​ . Consultar la página de manual de ​ resolv.conf y estudiar el significado de las opciones ​ nameserver y ​ search​ . Ver el
contenido del archivo en la máquina física del laboratorio.

resolver - fichero de configuración del servicio resolver


nameserver Dirección Internet (en notación punto) de un servidor de nombres que podría ser consultado por resolver.  Se listan hasta un máximo de MAXNS (actualmente 3)  servidores  de  nombre,  uno  por
           palabra  clave.   Si hay múltiples servidores, la biblioteca resolver los consulta en el orden listado.  Si no hay entradas nameserver presentes, por defecto se utiliza el servidor de nombres
           de la máquina local.  (El algoritmo usado consiste en intentar conectar a un servidor de nombres, y si la consulta excede un plazo de espera, probar el siguiente,  hasta  que  se  agoten  los
           servidores de nombres, luego repetir los intentos con todos los servidores de nombres hasta que se hagan un número máximo de reintentos.)


search Lista  de  búsqueda  de  nombres de host.  La lista de búsqueda está determinada normalmente por el nombre de dominio local; por defecto, contiene solo el nombre de dominio local.  Ésto puede
       cambiarse listando la ruta de búsqueda de dominio deseada después de la palabra clave search con espacios o carácteres tabulador que separen los nombres.  La mayoría de consultas de  resolver
       se  intentarán  usando  cada  componente  de  la ruta de búsqueda sucesivamente hasta que se encuentre una coincidencia.  Observe que este proceso puede resultar lento y generará un montón de
       tráfico en la red si los servidores para los dominios listados no son locales, y tales consultas sobrepasarán el plazo de espera si no hay un servidor disponible para uno de los dominios.
       La lista de búsqueda está actualmente limitada a seis dominios con un total de 256 carácteres.

Ejercicio 2. Partiendo únicamente del servidor raíz a.root-servers.net y de las respuestas obtenidas de cada servidor obtener la dirección IP de informatica.ucm.es. Determinar el TTL de cada registro y completar la siguiente tabla:


 ealcober@debian:~$ dig @a.root-servers.net informatica.ucm.es

; <<>> DiG 9.10.3-P4-Debian <<>> @a.root-servers.net informatica.ucm.es
; (2 servers found)
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 12160
;; flags: qr rd; QUERY: 1, ANSWER: 0, AUTHORITY: 7, ADDITIONAL: 14
;; WARNING: recursion requested but not available

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;informatica.ucm.es.        IN     A

#					  -TTL -CLASS -REG.TYPE -ZONE SERVERS

;; AUTHORITY SECTION:
es.                  172800 IN     NS     g.nic.es.
es.                  172800 IN     NS     ns-ext.nic.cl.
es.                  172800 IN     NS     f.nic.es.
es.                  172800 IN     NS     sns-pb.isc.org.
es.                  172800 IN     NS     a.nic.es.
es.                  172800 IN     NS     ns3.nic.fr.
es.                  172800 IN     NS     ns1.cesca.es.
# El registro Start of Authority (SOA) marca el comienzo de definición de una zona
# El registro Name Server (NS) especifica los servidores autoritativos para la zona
# El registro Address (A para IPv4 y AAAA para IPv6) es la base de DNS
# El registros Pointer (PTR) contiene la traducción inversa (IP → nombre)
# El registro Mail eXchanger (MX) es usado por los sistemas de correo para encaminar los mensajes eficientemente
# El registro CNAME se usa para definir un nombre canónico de un dominio, que permite definir alias para el nombre canónico

;; ADDITIONAL SECTION:
g.nic.es.            172800 IN     A      204.61.217.1
g.nic.es.            172800 IN     AAAA   2001:500:14:7001:ad::1
ns-ext.nic.cl.              172800 IN     A      200.1.123.14
f.nic.es.            172800 IN     A      130.206.1.7
f.nic.es.            172800 IN     AAAA   2001:720:418:caf1::7
sns-pb.isc.org.             172800 IN     A      192.5.4.1
sns-pb.isc.org.             172800 IN     AAAA   2001:500:2e::1
a.nic.es.            172800 IN     A      194.69.254.1
a.nic.es.            172800 IN     AAAA   2001:67c:21cc:2000::64:41
ns3.nic.fr.          172800 IN     A      192.134.0.49
ns3.nic.fr.          172800 IN     AAAA   2001:660:3006:1::1:1
ns1.cesca.es.        172800 IN     A      84.88.0.3
ns1.cesca.es.        172800 IN     AAAA   2001:40b0:1:1122:ce5c:a000:0:3

;; Query time: 31 msec
;; SERVER: 198.41.0.4#53(198.41.0.4)
;; WHEN: Tue Oct 09 18:20:11 CEST 2018
;; MSG SIZE  rcvd: 482

Ejercicio 3. Obtener el registro SOA de ucm.es. usando un servidor autoritativo de la zona. Identificar los campos relevantes del registro.

ealcober@debian:~$ dig -t SOA ucm.es.

; <<>> DiG 9.10.3-P4-Debian <<>> -t SOA ucm.es.
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 4312
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;ucm.es.				IN	SOA

nombre de la zona - servidor primario de nombres de la zona - email - s/n   -refresh-updt. rty-expiry-nxdomain ttl 
;; ANSWER SECTION:						|										  |	    | 		|	
ucm.es.			86388	IN	SOA	ucdns.sis.ucm.es. hostmaster.ucm.es. 2018100501 28800 7200 1209600 86400
																		... TEMPORIZADORES ... 
temporizadores: esclavo comprueba cambios cada ref, en caso de fallo reintenta cada ret, sirve ex segundos el dominio si no hay maestro y cachea respuestas negativas durante nx segundos

;; Query time: 5 msec
;; SERVER: 80.58.61.250#53(80.58.61.250)
;; WHEN: Sun Oct 14 23:32:33 CEST 2018
;; MSG SIZE  rcvd: 92

Ejercicio 4 ​ . Determinar qué servidor debería usarse para enviar un mail a ​ webmaster@fdi.ucm.es​ ,usar un servidor autoritativo de la zona.

ealcober@debian:~$ dig -t SOA webmaster@fdi.ucm.es​.

; <<>> DiG 9.10.3-P4-Debian <<>> -t SOA webmaster@fdi.ucm.es​.
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NXDOMAIN, id: 19607
;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1460
;; QUESTION SECTION:
;webmaster\@fdi.ucm.es\226\128\139. IN	SOA

;; AUTHORITY SECTION:
.			86400	IN	SOA	a.root-servers.net. nstld.verisign-grs.com. 2018101401 1800 900 604800 86400

;; Query time: 43 msec
;; SERVER: 80.58.61.250#53(80.58.61.250)
;; WHEN: Sun Oct 14 23:44:25 CEST 2018
;; MSG SIZE  rcvd: 127


ealcober@debian:~$ dig +authority -t MX fdi.ucm.es​

; <<>> DiG 9.10.3-P4-Debian <<>> +authority -t MX fdi.ucm.es​
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NXDOMAIN, id: 10832
;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1460
;; QUESTION SECTION:
;fdi.ucm.es\226\128\139.		IN	MX

;; AUTHORITY SECTION:
.			86400	IN	SOA	a.root-servers.net. nstld.verisign-grs.com. 2018101401 1800 900 604800 86400

;; Query time: 214 msec
;; SERVER: 80.58.61.250#53(80.58.61.250)
;; WHEN: Sun Oct 14 23:46:53 CEST 2018
;; MSG SIZE  rcvd: 117

Ejercicio 5 ​ . Determinar el nombre de dominio para ​ 147.96.85.71. Al igual que en el ejercicio 2,
usar únicamente el servidor raíz ​ a.root-servers.net y las respuestas obtenidas a partir de éste.
Completar la siguiente tabla:	

ealcober@debian:~$ dig @a.root-servers.net -x 147.96.85.71

; <<>> DiG 9.10.3-P4-Debian <<>> @a.root-servers.net -x 147.96.85.71
; (2 servers found)
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 19100
;; flags: qr rd; QUERY: 1, ANSWER: 0, AUTHORITY: 6, ADDITIONAL: 13
;; WARNING: recursion requested but not available

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;71.85.96.147.in-addr.arpa.	IN	PTR

;; AUTHORITY SECTION:
in-addr.arpa.		172800	IN	NS	e.in-addr-servers.arpa.
in-addr.arpa.		172800	IN	NS	f.in-addr-servers.arpa.
in-addr.arpa.		172800	IN	NS	d.in-addr-servers.arpa.
in-addr.arpa.		172800	IN	NS	c.in-addr-servers.arpa.
in-addr.arpa.		172800	IN	NS	b.in-addr-servers.arpa.
in-addr.arpa.		172800	IN	NS	a.in-addr-servers.arpa.

;; ADDITIONAL SECTION:
e.in-addr-servers.arpa.	172800	IN	A	203.119.86.101
e.in-addr-servers.arpa.	172800	IN	AAAA	2001:dd8:6::101
f.in-addr-servers.arpa.	172800	IN	A	193.0.9.1
f.in-addr-servers.arpa.	172800	IN	AAAA	2001:67c:e0::1
d.in-addr-servers.arpa.	172800	IN	A	200.10.60.53
d.in-addr-servers.arpa.	172800	IN	AAAA	2001:13c7:7010::53
c.in-addr-servers.arpa.	172800	IN	A	196.216.169.10
c.in-addr-servers.arpa.	172800	IN	AAAA	2001:43f8:110::10
b.in-addr-servers.arpa.	172800	IN	A	199.253.183.183
b.in-addr-servers.arpa.	172800	IN	AAAA	2001:500:87::87
a.in-addr-servers.arpa.	172800	IN	A	199.180.182.53
a.in-addr-servers.arpa.	172800	IN	AAAA	2620:37:e000::53

;; Query time: 48 msec
;; SERVER: 198.41.0.4#53(198.41.0.4)
;; WHEN: Sun Oct 14 23:49:21 CEST 2018
;; MSG SIZE  rcvd: 430

ealcober@debian:~$ dig  -x 147.96.85.71 -t PTR

; <<>> DiG 9.10.3-P4-Debian <<>> -x 147.96.85.71 -t PTR
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 22257
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1460
;; QUESTION SECTION:
;71.85.96.147.in-addr.arpa.	IN	PTR

;; ANSWER SECTION:
71.85.96.147.in-addr.arpa. 86400 IN	PTR	www.fdi.ucm.es.

;; Query time: 9 msec
;; SERVER: 80.58.61.250#53(80.58.61.250)
;; WHEN: Sun Oct 14 23:52:42 CEST 2018
;; MSG SIZE  rcvd: 82

Ejercicio 6 ​ . Obtener la IP de ​ www.google.com usando el servidor por defecto. Usar el comando ​ dig
con la opción ​ +trace​ y observar las consultas realizadas.

ealcober@debian:~$ dig -t A +trace www.google.com. 

; <<>> DiG 9.10.3-P4-Debian <<>> -t A +trace www.google.com.
;; global options: +cmd
.			53176	IN	NS	m.root-servers.net.
.			53176	IN	NS	b.root-servers.net.
.			53176	IN	NS	c.root-servers.net.
.			53176	IN	NS	d.root-servers.net.
.			53176	IN	NS	e.root-servers.net.
.			53176	IN	NS	f.root-servers.net.
.			53176	IN	NS	g.root-servers.net.
.			53176	IN	NS	h.root-servers.net.
.			53176	IN	NS	i.root-servers.net.
.			53176	IN	NS	a.root-servers.net.
.			53176	IN	NS	j.root-servers.net.
.			53176	IN	NS	k.root-servers.net.
.			53176	IN	NS	l.root-servers.net.
;; Received 755 bytes from 80.58.61.250#53(80.58.61.250) in 4 ms

com.			172800	IN	NS	l.gtld-servers.net.
com.			172800	IN	NS	f.gtld-servers.net.
com.			172800	IN	NS	b.gtld-servers.net.
com.			172800	IN	NS	h.gtld-servers.net.
com.			172800	IN	NS	d.gtld-servers.net.
com.			172800	IN	NS	k.gtld-servers.net.
com.			172800	IN	NS	e.gtld-servers.net.
com.			172800	IN	NS	i.gtld-servers.net.
com.			172800	IN	NS	c.gtld-servers.net.
com.			172800	IN	NS	m.gtld-servers.net.
com.			172800	IN	NS	j.gtld-servers.net.
com.			172800	IN	NS	a.gtld-servers.net.
com.			172800	IN	NS	g.gtld-servers.net.
com.			86400	IN	DS	30909 8 2 E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766
com.			86400	IN	RRSIG	DS 8 1 86400 20181027170000 20181014160000 2134 . Wx8SVRqhdyeEPv0lhuJcUOcWUCnfN642PL1ScnLwh1PIQhFsK6lKrLMG FLS9BVDDe+vRJkK1q9Rv7vjUkrLqsownAub0qjMymLZ/9Vtvk7JmztcI 0ksV8mQQpR0UPA135EQ6vlLP9H1Mw3xLoH+LW4seC/uJTxXV3MNGSyzP qH16AhKQ0vocscylEF8wOhrCHu5aHYqyfLyEja4+1LwLhetB+ExicxnB q4Oa2hpbvSX3/JkLaP9QLguRj91vPvE1n0weIBTqVRZJsebguBE3rOiM Bs8qsZPgrAcF8XoIgUDj37czYfqYSbPE3mFxM2w4bQ+CAuPnqS58kX99 rF6y3w==
;; Received 1174 bytes from 192.112.36.4#53(g.root-servers.net) in 121 ms

google.com.		172800	IN	NS	ns2.google.com.
google.com.		172800	IN	NS	ns1.google.com.
google.com.		172800	IN	NS	ns3.google.com.
google.com.		172800	IN	NS	ns4.google.com.
CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN NSEC3 1 1 0 - CK0Q1GIN43N1ARRC9OSM6QPQR81H5M9A NS SOA RRSIG DNSKEY NSEC3PARAM
CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN RRSIG NSEC3 8 2 86400 20181020121530 20181013110530 46475 com. dwbSHWsE9XgYaIlfAvddRHnM+SyareZ63CYwXOcbO3tcu7wpslbjNn37 tbqnZa89rsIKO1mzWUdxM5fQtXXj2k+haz8SV42mtiU9WvkXBx0jnUjn 18UXq+X1u/uLfwPOIIy0tDcFW8OdQB3nE18aCVIzy9YUcrFMilNQ+vP6 OSM=
S849LHDDSVU9A9N2FIRO5NKMQB321BEP.com. 86400 IN NSEC3 1 1 0 - S84CFH3A62N0FJPC5D9IJ2VJR71OGLV5 NS DS RRSIG
S849LHDDSVU9A9N2FIRO5NKMQB321BEP.com. 86400 IN RRSIG NSEC3 8 2 86400 20181020045927 20181013034927 46475 com. 05o91aUzWRIWuEscn1l7vytNshnao/0pHicigD1+PlHFzHqAbZNqwlGR fLI347YtDI/7vrMuqyJY3YZSuzbmj8ce7TF7BY0pufB6Vx0DhkOj4XVw 4Y4+5ZjoFQB3IGF6dy/V74anDXxaKaoc49Zi9w+9F9nouWNrrIGSFGa0 o/w=
;; Received 776 bytes from 192.43.172.30#53(i.gtld-servers.net) in 41 ms

www.google.com.		300	IN	A	216.58.201.164
;; Received 48 bytes from 216.239.38.10#53(ns4.google.com) in 24 ms


